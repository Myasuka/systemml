
%The order statistic of rank $k$ in a given sample $S$ = $\{x_1, x_2, \cdots x_n\}$ of size $n$ is equal to the $k^{th}$ smallest value, and is commonly denoted as $x_{(k)}$. In other words, they represent sample values placed in an ascending order, $x_{(1)} \leq x_{(2)} \leq \cdots \leq x_{(n)}$. 
%Order statistics, such as \textit{min}, \textit{max}, \textit{median} and \textit{quantile}, impose an order on the set of date items in order to describe the data. They are an important subset of descriptive analysis. \textit{min} and \textit{max} can still be expressed in a summation form, like most of the rest descriptive statistics, but \textit{median} and \textit{quantile}  pose an challenge to the runtime implementation of SystemML. As \textit{median} is a special case of \textit{quantile}, for the rest of the paper, we will focus on implementing \textit{quantile} in SystemML. In SystemML, we support a very general \textit{quantile} function: $Y=quantile(X, P)$, where $X$ is a vector contains the input data items, $P$ is a vector of values in $(0, 1)$ indicating the quantiles to be computed, and $Y$ is a vector with the same size of $P$ containing the quantiles specified in $P$. 

%Order statistics are one of the fundamental tools in non-parametric data analysis. The order statistic of rank $k$ in a given sample $S$ = $\{x_1, x_2, \cdots x_n\}$ of size $n$ is equal to the $k^{th}$ smallest value, and is commonly denoted as $x_{(k)}$. In other words, they represent sample values placed in an ascending order, $x_{(1)} \leq x_{(2)} \leq \cdots \leq x_{(n)}$. The extreme values $x_{(1)}$ and $x_{(n)}$ correspond to the {\em minimum} and {\em maximum} values in the input data sample. Their difference $(x_{(n)} - x_{(1)})$ measures the dispersion in the sample, and is referred to as {\em sample range}. Another important statistic {\em sample median} is a robust estimate of sample location, and is defined as a value that separates higher half of the sample from the lower half. This can be generalized to define other sample {\em quantiles}. The $p$-quantile of $S$ is a number $q_p = x_{\lceil p\cdot n \rceil}$ such that $p\cdot n$ elements in the set are less than or equal to $q_p$, and $(1-p)\cdot n$ elements are greater than $q_p$. 

Order statistics are one of the fundamental tools in non-parametric data analysis. They can be used to represent various statistics, such as \textit{min}, \textit{max}, \textit{range}, \textit{median}, \textit{quantiles} and \textit{inter-quartile mean}. Although order statistics do not suffer from numerical stability problems, computing them efficiently in MapReduce is a challenge.

Arbitrary order statistics from a set of $n$ numbers can be computed sequentially in $O(n)$ time using the popular BFPRT algorithm~\cite{blum1973time}. There exist several efforts such as~\cite{bader2004improved} that attempt to parallelize the sequential BFPRT algorithm. The core idea is to determine the required order statistic {\em iteratively} by {\em dynamically redistributing} the data in each iteration among different cluster nodes to achieve load balancing. These iterative algorithms are suited for MPI-style parallelization but they are not readily applicable to MapReduce, as they require multiple MapReduce jobs with multiple disk reads and writes. Furthermore, message passing in MapReduce can only be achieved through the heavy-weight shuffling mechanism. %As a result, such methods typically suffer from poor performance in MapReduce. 
In SystemML, we therefore devised a sort-based algorithm by leveraging Hadoop's inherent capability to sort large set of numbers. This algorithm needs only one full MapReduce job to sort the input data, plus one partial scan of the sorted data to compute the required order statistics. Note that there have also been studies on parallel approximate order statistics algorithms~\cite{chaudhuri1993approximate}, but in this paper, we focus only on algorithms for exact order statistics. 

%They incur significant overhead due to high startup cost in Hadoop jobs, heartbeat messages between job tracker and tasks, and disk-based input/output. Therefore in SystemML, we devise a sorting-based mechanism by leveraging the capabilities of Hadoop to sort large set of numbers, as established in several earlier studies~\cite{terasort}. We briefly summarize our method below. There has also been studies on parallel approximate order statistics algorithms~\cite{chaudhuri1993approximate}, but we focus on exact order statistics algorithms in this paper. 
%As established by several studies~\cite{hadoopsort}, Hadoop can be used effectively to sort a large set of numbers, and we leverage this capability to devise a sorting-based selection mechanism, which we summarize below.
