X = read($1, rows=$2, cols=1, format="text")

n = $2

Helper=Rand(rows = 1, cols = 1, min = 1, max = 1);


######### UNIVARIATE STATISTICS #############

# sum
s1=sum(X)

# sum squared
s2=sum(X^2)

# sum cub
s3=sum(X^3)

# sum quart
s4=sum(X^4)

# mean
mu = s1/n

# variance
var= (s2-s1*mu)/(n-1)

# column standard deviations
std = sqrt(var)

# Kurtosis (using binomial formula)
g2 = (s4 - 4*s3*mu + 6*s2*mu^2 - 3*n*mu^4)/(n*var^2) - 3

# Skewness
g1 = (s3 - 3*mu*s2 + 2*n*mu^3)/(n*std*var)

s1Helper=s1*Helper
muHelper=mu*Helper
stdHelper=std*Helper
varHelper=var*Helper
g2Helper=g2*Helper
g1Helper=g1*Helper

write(muHelper,$3,format="binary")
write(stdHelper,$4,format="binary")
write(varHelper,$5,format="binary")
write(g2Helper,$6,format="binary")
write(g1Helper,$7,format="binary")
write(s1Helper,$8,format="binary")
