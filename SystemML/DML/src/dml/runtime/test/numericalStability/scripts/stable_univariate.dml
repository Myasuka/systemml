#-f src/dml/runtime/test/numericalStability/scripts/stable_univariate.dml 'ReferenceData/NumAcc2.dat.mtx' 1001 'mu' 'std' 'var' 'g2' 'g1' 's'

V = read($1, rows=$2, cols=1, format="text")

n = $2

Helper=Rand(rows = 1, cols = 1, min = 1, max = 1);

# sum
s1 = sum(V)

# 2nd central moment
m2 = centralMoment(V, 2)

# 3rd central moment
m3 = centralMoment(V, 3)

# 4th central moment
m4 = centralMoment(V, 4)

# mean
mu = mean(V)

# variances
var = n/(n-1.0)*m2

# standard deviations
std_dev = sqrt(var)

# Skewness
g1 = m3/(std_dev^3)

# Kurtosis (using binomial formula)
g2 = m4/(std_dev^4) - 3

s1Helper=s1*Helper
muHelper=mu*Helper
stdHelper=std_dev*Helper
varHelper=var*Helper
g1Helper=g1*Helper
g2Helper=g2*Helper

write(muHelper,$3,format="binary")
write(stdHelper,$4,format="binary")
write(varHelper,$5,format="binary")
write(g2Helper,$6,format="binary")
write(g1Helper,$7,format="binary")
write(s1Helper,$8,format="binary")