# JUnit test class: dml.test.integration.applications.GNMFTest.java

V = readMM("$$indir$$v", rows=$$m$$, cols=$$n$$, format="text");
W = readMM("$$indir$$w", rows=$$m$$, cols=$$k$$, format="text");
H = readMM("$$indir$$h", rows=$$k$$, cols=$$n$$, format="text");
max_iteration = $$maxiter$$;
i = 0;

Eps = 10^-8;

while(i < max_iteration) {
	H = H * ((t(W) %*% V) / (((t(W) %*% W) %*% H)+Eps)) ;
	W = W * ((V %*% t(H)) / ((W %*% (H %*% t(H)))+Eps));
	i = i + 1;
}

writeMM(W, "$$outdir$$w", format="text");
writeMM(H, "$$outdir$$h", format="text");