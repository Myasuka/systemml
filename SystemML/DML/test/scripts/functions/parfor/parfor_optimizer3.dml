#-------------------------------------------------------------
# IBM Confidential
# OCO Source Materials
# (C) Copyright IBM Corp. 2010, 2013
# The source code for this program is not published or
# otherwise divested of its trade secrets, irrespective of
# what has been deposited with the U.S. Copyright Office.
#-------------------------------------------------------------

V = read($1,rows=$2,cols=$3);
n = $3;
nd = $4;

R = matrix(0, rows=1,cols=nd); 
dummy = matrix(1, rows=1, cols=1);

parfor( i in 1:(n/2), opt=RULEBASED )
{
   X = V[ ,i];                 
   Y = V[ ,n-i+1];                 
   sx = execSum(X);
   sy = execSum(Y);
   R[1,i] = dummy*( sx+sy ); 
}   

write(R, $5);       


execSum = function(Matrix[Double] X) return (Double sx) 
{
   if( ncol(X) > 0 )
   {
      sx = sum(X);    
   }
   else
   {
      sx = sum(X);
   }
}