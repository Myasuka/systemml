#-------------------------------------------------------------
# IBM Confidential
# OCO Source Materials
# (C) Copyright IBM Corp. 2010, 2013
# The source code for this program is not published or
# otherwise divested of its trade secrets, irrespective of
# what has been deposited with the U.S. Copyright Office.
#-------------------------------------------------------------

$$readhelper$$

V = read("$$indir$$vector", rows=$$rows$$, cols=1, format="text")
W = read("$$indir$$weight", rows=$$rows$$, cols=1, format="text")

# median
md = median(V) #quantile(V, 0.5)
medianHelper1 = md * Helper;
write(medianHelper1, "$$outdir$$median", format="text");

# weighted median
wmd = median(V,W) #quantile(V, W, 0.5)
medianHelper2 = wmd * Helper;
write(medianHelper2, "$$outdir$$weighted_median", format="text");